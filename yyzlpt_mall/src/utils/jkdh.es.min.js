const e=e=>{window.WebViewJavascriptBridge?e(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",()=>{e(WebViewJavascriptBridge)},!1)};var i=()=>new Promise((e,i)=>{(e=>{if(window.WebViewJavascriptBridge)return e(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];let i=document.createElement("iframe");i.style.display="none",i.src="https://__bridge_loaded__",document.documentElement.appendChild(i),setTimeout(function(){document.documentElement.removeChild(i)},0)})(i=>{e(i)})});const t=[{name:"Android",deviceType:"mobile",osReg:/Android[\s\_\-\/i686]?[\s\_\-\/](\d+[\.\-\_]\d+[\.\-\_]?\d*)/i,getVersion:(e,i)=>e.match(i)[1]},{name:"iOS",deviceType:"mobile",osReg:/OS (.*) like Mac OS X/,getVersion:(e,i)=>e.match(i)[1]}],r=[{appName:"yygh",appAlias:"\u5065\u5eb7\u5bfc\u822a",skdFeature:[/yygh\_(iOS|android)/],sdkVariable:"rc"}],n=window.navigator.userAgent,a=(e=>{let i=null;return t.forEach(t=>{t.osReg.test(e)&&(i={name:t.name,deviceType:t.deviceType,version:t.getVersion(e,t.osReg)})}),i})(n),s=(e=>{let i=null;return r.forEach(t=>{let{appName:r,appAlias:n,sdkUrl:a,skdFeature:s,sdkVariable:o}=t;s.every(i=>i.test(e))&&(i={appName:r,appAlias:n,sdkUrl:a,sdkVariable:o})}),i})(n);function o(e){return"true"==localStorage.getItem("debug")?i=>{let t="string"==typeof i;i=t||JSON.stringify(i,2),console.log(`%c  jkdh-sdk: ${i}`,`color:${e}`)}:e=>{}}o("#0A1F44");const d=o("#0C66FF"),c=(o("#FFCA65"),o("#F03D3Dfff")),l=(e,i)=>(d(i),new Promise((t,r)=>{window.WebViewJavascriptBridge||(c("\u5f53\u524djsapi\u4e0d\u53ef\u7528"),r());try{i=Object.assign({},{success(){},fail(){}},i),WebViewJavascriptBridge.callHandler(e,i,r=>{d(r),window.JKDH_SKD_DEBUGGER&&JKDH_SKD_DEBUGGER(r,e),t(r),"0"===r.code?i&&i.success(r.result):i&&i.fail()})}catch(e){c(e),r(e)}})),p=(e,i,t)=>{if(!t)return l(e,i);let r=null;for(let e in t){let n=t[e],a=i[e],s=n.type.name,o=Object.prototype.toString.call(a)===`[object ${s}]`;if(n.required&&!a&&(r=`${e}\u4e0d\u80fd\u4e3a\u7a7a`),!o&&a&&(r=`${e}\u7684\u7c7b\u578b\u5fc5\u987b\u662f\u4e2a${s}`),n.vaild){vaild(a).isVaild||(r=`${e}\u6ca1\u6709\u901a\u8fc7\u6821\u9a8c`)}}return r?(i.fail&&i.fail(r),window.JKDH_SKD_DEBUGGER(r,e+"\u914d\u7f6e\u51fa\u9519"),Promise.reject(r)):l(e,i)},u={appId:{type:String,required:!0,default:""},timestamp:{type:Number,required:!0,default:""},nonceStr:{type:String,required:!0,default:""},signature:{type:String,required:!0,default:""},jsApiList:{type:Array,default:[]}},g=t=>{if(!s){let e="\u5f53\u524d\u4e0d\u662f\u5065\u5eb7\u5bfc\u822aapp\u73af\u5883,\u65e0\u6cd5\u4f7f\u7528\u76f8\u5173jsApi";return Promise.reject(e)}return"Android"===a.name?(()=>new Promise((i,t)=>{window.WebViewJavascriptBridge?e(e=>{i(e)}):document.addEventListener("WebViewJavascriptBridgeReady",()=>{e(e=>{i(e)})},!1)}))():"iOS"===a.name?i():Promise.reject("jsSDK\u6ce8\u5165\u5931\u8d25")},w=e=>g().then(i=>(window.WebViewJavascriptBridge||(window.JKDH_SKD_DEBUGGER=null,window.WebViewJavascriptBridge=i),e&&e(i),Promise.resolve()),e=>Promise.reject(e)),m=e=>{if(e){if("string"==typeof e)return"alert"===e?alert:console[e];if(e instanceof Function)return e}return()=>{}},f={appId:{type:String,required:!0,default:""},scope:{type:String,required:!0,default:""}};const b={activity:{type:String,required:!0,default:""}};const y=e=>e.map(e=>(e=>{return e.replace(/(?!^)\.(\w)/g,(e,i)=>i.toLocaleUpperCase())})(e));export default{...{platForm:{appInfo:s,os:a},setting:{},ready:w,error(e){this.showConifgError=m(errName)},debug(e){window.JKDH_SKD_DEBUGGER=m(e)},config(e){w().then(i=>{let{setting:t}=this;return(e=>p("configApi",e,u))(t=Object.assign({},t,e)).catch(e=>{this.showConifgError?this.showConifgError(e):console.error(e)})})}},base:{getApiList:e=>{const i=["base.getApiList","base.encryptString","auth.getAuthCode","business.share","device.getLocation","ui.setTitle","ui.closeWindow","ui.scanQRCode","ui.chooseImage","ui.previewImage","ui.uploadImage","ui.downloadImage"];let{jsApiList:t}=e;return e.jsApiList=y(t&&"all"!==t?t:i),p("baseGetApiList",e)},encryptString:e=>p("baseEncryptString",e)},auth:{getAuthCode:e=>p("authGetCode",e,f),login:e=>(((e,i)=>new Promise((t,r)=>{WebViewJavascriptBridge.registerHandler(e,(e,n)=>{try{"string"==typeof e&&(e=JSON.parse(e)),i&&i instanceof Function&&i(e),t(e),n({code:"0",message:"js\u6267\u884c\u6210\u529f"})}catch(e){r(e),n({code:"1",message:JSON.stringify(e)})}})}))("appLoginSuccessed".options.onsuccessed),p("loginFromApp",e,f))},device:{getLocation:e=>p("deviceGetLocation",e),getNetworkType:e=>p("deviceGetLocation",e),getDeviceInfo:e=>p("deviceGetDeviceInfo",e),onNetworkChanged:e=>p("deviceOnNetworkChanged",e)},business:{share:e=>p("businessShare",e),telPhone:e=>p("businessTelPhone",e),openMap:e=>p("businessOpenMap",e)},ui:{setTitle:e=>p("uiSetTitle",e),closeWindow:e=>p("uiCloseWindow",e),scanQRCode:e=>p("uiScanQRCode",e),jumpToAppPage:e=>{let{activity:i,query:t}=e;return e.activity=((e,i)=>{let t="";if(i)for(let e in i)t+=`&${e}=${i[e]}`;return/\?/.test(e)||(t="?"+t.substr(1)),`${e}${t}`})(i,t),p("uiJumpToAppPage",e,b)}}};