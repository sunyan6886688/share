const e=e=>{window.WebViewJavascriptBridge?e(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",()=>{e(WebViewJavascriptBridge)},!1)};var i=()=>new Promise((e,i)=>{(e=>{if(window.WebViewJavascriptBridge)return e(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];let i=document.createElement("iframe");i.style.display="none",i.src="https://__bridge_loaded__",document.documentElement.appendChild(i),setTimeout(function(){document.documentElement.removeChild(i)},0)})(i=>{e(i)})});const t=[{name:"Android",deviceType:"mobile",osReg:/Android[\s\_\-\/i686]?[\s\_\-\/](\d+[\.\-\_]\d+[\.\-\_]?\d*)/i,getVersion:(e,i)=>e.match(i)[1]},{name:"iOS",deviceType:"mobile",osReg:/OS (.*) like Mac OS X/,getVersion:(e,i)=>e.match(i)[1]}],r=[{appName:"yygh",appAlias:"\u5065\u5eb7\u5bfc\u822a",skdFeature:[/yygh\_(iOS|android)/],sdkVariable:"rc"}],a=window.navigator.userAgent,n=(e=>{let i=null;return t.forEach(t=>{t.osReg.test(e)&&(i={name:t.name,deviceType:t.deviceType,version:t.getVersion(e,t.osReg)})}),i})(a),s=(e=>{let i=null;return r.forEach(t=>{let{appName:r,appAlias:a,sdkUrl:n,skdFeature:s,sdkVariable:o}=t;s.every(i=>i.test(e))&&(i={appName:r,appAlias:a,sdkUrl:n,sdkVariable:o})}),i})(a);function o(e){return"true"==localStorage.getItem("debug")?i=>{"log"==e?console.log(i):console[e](`jkdh-sdk ${e}: ${i}`)}:e=>{}}const d=o("log"),c=o("info"),p=o("warn"),l=o("error"),u=(e,i)=>(d(i),new Promise((t,r)=>{window.WebViewJavascriptBridge||(l("\u5f53\u524djsapi\u4e0d\u53ef\u7528"),r());try{i=Object.assign({},{success(){},fail(){}},i),WebViewJavascriptBridge.callHandler(e,i,r=>{"string"==typeof r&&(r=JSON.parse(r)),c(`\u5ba2\u6237\u7aef\u65b9\u6cd5${e}\u8c03\u7528\u6210\u529f`),d(r),window.JKDH_SKD_DEBUGGER&&JKDH_SKD_DEBUGGER(r,e),t(r),"0"===r.code?i&&i.success(r):i&&i.fail()})}catch(e){l(e),r(e)}})),g=(e,i,t)=>{if(!t)return u(e,i);let r=null;for(let e in t){let a=t[e],n=i[e],s=a.type.name,o=Object.prototype.toString.call(n)===`[object ${s}]`;if(a.required&&!n&&(r=`${e}\u4e0d\u80fd\u4e3a\u7a7a`),!o&&n&&(r=`${e}\u7684\u7c7b\u578b\u5fc5\u987b\u662f\u4e2a${s}`),a.vaild){vaild(n).isVaild||(r=`${e}\u6ca1\u6709\u901a\u8fc7\u6821\u9a8c`)}}return r?(l(e+"\n\u65b9\u6cd5\u53c2\u6570\u4e0d\u6b63\u786e"+r),i.fail&&i.fail(r),window.JKDH_SKD_DEBUGGER&&JKDH_SKD_DEBUGGER(r,e+"\u914d\u7f6e\u51fa\u9519"),Promise.reject(r)):u(e,i)},w={appId:{type:String,required:!0,default:""},timestamp:{type:String,required:!0,default:""},nonceStr:{type:String,required:!0,default:""},signature:{type:String,required:!0,default:""},jsApiList:{type:Array,default:[]}},m=t=>{if(!s){let e="\u5f53\u524d\u4e0d\u662f\u5065\u5eb7\u5bfc\u822aapp\u73af\u5883,\u65e0\u6cd5\u4f7f\u7528\u76f8\u5173jsApi";return p(e),Promise.reject(e)}return"Android"===n.name?(()=>new Promise((i,t)=>{window.WebViewJavascriptBridge?e(e=>{i(e)}):document.addEventListener("WebViewJavascriptBridgeReady",()=>{e(e=>{i(e)})},!1)}))():"iOS"===n.name?i():Promise.reject("jsSDK\u6ce8\u5165\u5931\u8d25")},v=e=>m().then(i=>(window.WebViewJavascriptBridge||(window.JKDH_SKD_DEBUGGER=null,window.WebViewJavascriptBridge=i),c("WebViewJavascriptBridge\u521d\u59cb\u5316\u5b8c\u6210"),e&&(c("\u6267\u884cready\u5185\u7684\u56de\u8c03"),e(i)),Promise.resolve()),e=>(l(e),Promise.reject(e))),f=e=>{if(e){if("string"==typeof e)return"alert"===e?alert:console[e];if(e instanceof Function)return e}return()=>{}},y={platForm:{appInfo:s,os:n},setting:{},ready:v,error(e){this.showConifgError=f(e),c("\u81ea\u5b9a\u4e49\u83b7\u53d6\u9519\u8bef")},debug(e){window.JKDH_SKD_DEBUGGER=f(e),c("\u81ea\u5b9a\u4e49\u83b7\u53d6debug\u65b9\u5f0f")},config:e=>v().then(i=>{let{setting:t}=y;return t=Object.assign({},t,e),d(t),(e=>g("configApi",e,w))(t).catch(e=>{l(e)})})},b={appId:{type:String,required:!0,default:""},scope:{type:String,required:!0,default:""}};var S={getAuthCode:e=>g("authGetCode",e,b),login:e=>(((e,i)=>new Promise((t,r)=>{WebViewJavascriptBridge.registerHandler(e,(a,n)=>{c(e+"\u6267\u884c\u6210\u529f"),d(a);try{"string"==typeof a&&(a=JSON.parse(a)),i&&i instanceof Function&&i(a),t(a),n({code:"0",message:`${e}\u6267\u884c\u6210\u529f`})}catch(e){l(e),r(e),n({code:"1",message:JSON.stringify(e)})}})}))("appLoginSuccessed".options.onsuccessed),g("loginFromApp",e,b))};const h={activity:{type:String,required:!0,default:""}};var J={setTitle:e=>g("uiSetTitle",e),closeWindow:e=>g("uiCloseWindow",e),scanQRCode:e=>g("uiScanQRCode",e),jumpToAppPage:e=>{let{activity:i,query:t}=e;return e.activity=((e,i)=>{let t="";if(i)for(let e in i)t+=`&${e}=${i[e]}`;return/\?/.test(e)||(t="?"+t.substr(1)),`${e}${t}`})(i,t),g("uiJumpToAppPage",e,h)}};const B=e=>e.map(e=>(e=>{return e.replace(/(?!^)\.(\w)/g,(e,i)=>i.toLocaleUpperCase())})(e));var V={getApiList:e=>{const i=["base.getApiList","base.encryptString","auth.getAuthCode","business.share","device.getLocation","ui.setTitle","ui.closeWindow","ui.scanQRCode","ui.chooseImage","ui.previewImage","ui.uploadImage","ui.downloadImage"];let{apiList:t}=e;return e.apiList=B(t&&"all"!==t?t:i),g("baseGetApiList",e)},encryptString:e=>g("baseEncryptString",e)};var _={getLocation:e=>g("deviceGetLocation",e),getNetworkType:e=>g("deviceGetLocation",e),getDeviceInfo:e=>g("deviceGetDeviceInfo",e),onNetworkChanged:e=>g("deviceOnNetworkChanged",e),UserStatisticPage:e=>g("UserStatisticPage",e)};var D={share:e=>g("businessShare",e),telPhone:e=>g("businessTelPhone",e),openMap:e=>g("businessOpenMap",e),CCBPay:e=>g("CCBPay",e)};export default{...y,base:V,auth:S,device:_,business:D,ui:J};